// method to get deeply nested map values
@function map-deep-get($map, $keys...) {
  @each $key in $keys {
    $map: map-get($map, $key);
  }
  @return $map;
}

// function to return a breakpoint value from the breakpoint map
// remember as "griddle breakpoint" or "get breakpoint"
// -----------------------------------------------------------------------------
@function gbp($bp) {
  @if map-has-key($g-breakpoints, #{$bp}) {
    @return map-deep-get($g-breakpoints, #{$bp}, 'width');
  }
  @warn "The breakpoint key '#{$bp}' is not in the map ’$g-breakpoints’";
  @return null;
};

// Creates styles for a root element contained space
// -----------------------------------------------------------------------------
@mixin g-container ($container: margin) {
  @each $bp, $bp-data in $g-breakpoints {
    @if $bp == "base" {
      #{$container}-left: map-deep-get($g-breakpoints, #{$bp}, 'inset');
      #{$container}-right: map-deep-get($g-breakpoints, #{$bp}, 'inset');
      max-width: $g-max-body-width;
    } @else {
      @media (min-width: gbp(#{$bp})) {
        @if map-deep-get($g-breakpoints, #{$bp}, 'inset') == auto {
          #{$container}-left: map-deep-get($g-breakpoints, #{$bp}, 'inset');
          #{$container}-right: map-deep-get($g-breakpoints, #{$bp}, 'inset');

          @if $container == padding {
            container: $container;
            margin-left: auto;
            margin-right: auto;
          }
        } @else {
          #{$container}-left: map-deep-get($g-breakpoints, #{$bp}, 'inset');
          #{$container}-right: map-deep-get($g-breakpoints, #{$bp}, 'inset');
        }
      }
    }
  }
}

// Creates styles for the griddle visual overlay
// -----------------------------------------------------------------------------
@mixin g-overlay () {
  @each $bp, $bp-data in $g-breakpoints {
    @if $bp == "base" {
      display: grid;
      grid-template-columns: $g-column-template;
      grid-column-gap: $g-column-gap;
      pointer-events: none;
      z-index: 110;
      position: fixed;
      height: 100%;
      top: 0;
      bottom: 0;
      right: map-deep-get($g-breakpoints, #{$bp}, 'inset');
      left: map-deep-get($g-breakpoints, #{$bp}, 'inset');
    } @else {
      @media (min-width: gbp(#{$bp})) {
        @if map-deep-get($g-breakpoints, #{$bp}, 'inset') == auto {
          left: 50%;
          right: auto;
          transform: translateX($g-max-body-width / -2);
          width: 100%;
          max-width: $g-max-body-width;
        } @else {
          left: map-deep-get($g-breakpoints, #{$bp}, 'inset');
          right: map-deep-get($g-breakpoints, #{$bp}, 'inset');
        }
      }
    }
  }
}

// Function to create a percentage width spanning n columns.
// -----------------------------------------------------------------------------
@function g-span($columns, $extra_gutters: 0, $context: 0) {
  $gutters: 0;

  @if $columns == 0 {
    $gutters: $extra_gutters;
  } @else {
    $gutters: $extra_gutters + ($columns - 1);
  }

  @if $context != 0{
    @return ((($columns * $g-column) + ($gutters * $g-gutter)) / $context) * 100%;
  } @else {
    @return (($columns * $g-column) + ($gutters * $g-gutter));
  }
}

// Creates a decimal between 0-1 that defines a span of columns
// -----------------------------------------------------------------------------
@function g-span-decimal($columns, $extra_gutters: 0, $context: 0) {
  $gutters: 0;

  @if $columns == 0 {
    $gutters: $extra_gutters;
  } @else {
    $gutters: $extra_gutters + ($columns - 1);
  }

  @if $context != 0{
    @return ((($columns * $g-column-decimal) + ($gutters * $g-gutter-decimal)) / $context);
  } @else {
    @return (($columns * $g-column-decimal) + ($gutters * $g-gutter-decimal));
  }
}
